<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pierre Chevallier" />


<title>htsr-package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">htsr-package</h1>
<h4 class="author">Pierre Chevallier</h4>



<p><em>HydroSciences Laboratory (IRD, CNRS, Univ. Montpellier),
France</em></p>
<p><strong>v1.1.5 - date 22-11-06</strong></p>
<div id="content" class="section level1">
<h1>Content</h1>
<ul>
<li>Origin
<ul>
<li>Brief history</li>
<li>Hydraccess</li>
<li>Sqlite data base</li>
</ul></li>
<li>Principles</li>
<li>Dependencies
<ul>
<li>System library</li>
<li>User library</li>
<li>Special case of RODBC</li>
</ul></li>
<li>File formats
<ul>
<li>Sqlite data base</li>
<li>Time-series</li>
<li>Calibrations and discharge measurements</li>
<li>Gaps</li>
</ul></li>
<li>Functions
<ul>
<li>Short cut fonction</li>
<li>Data base functions</li>
<li>File functions</li>
<li>Hydro-meteo time-series</li>
<li>Plot functions</li>
<li>Micellaneous functions</li>
</ul></li>
<li>Development main references
<ul>
<li>Sqlite management</li>
<li>R coding</li>
</ul></li>
<li>Appendix
<ul>
<li>Correspondence of the data base tables between Hydraccess and Sqlite
htsr</li>
<li>Fields of the main tables</li>
</ul></li>
</ul>
</div>
<div id="origin" class="section level1">
<h1>Origin</h1>
<div id="brief-history" class="section level2">
<h2>Brief history</h2>
<p>IRD and previously ORSTOM have developed quite early (in the 70ties)
data bases for storing hydrological and meteorological time-series.
During the 80ties the managing tools use home-made codes (Hydrom and
Pluviom), which were in the late 90ties adapted with commercial
applications like Microsoft Access or Oracle and more recently for web
interface.</p>
<p>With the development of open access platforms and applications, in
the one hand, and the need of more flexibility, in the other hand, it
appears useful to build a set of functions able to manage hydro-meteo
time-series independently of the operating system and of proprietary
tools.</p>
<p>The <code>htsr</code> package was developed on the basis of the
public domain data base management system Sqlite and on the hydro-meteo
time-series data base application Hydraccess.</p>
<p>It works on Linux, Windows or MacOS platforms, with the free
programming language R and the interface RStudio preliminary
installed.</p>
</div>
<div id="hydraccess" class="section level2">
<h2>Hydraccess</h2>
<p>Hydraccess was developed at IRD (<a href="https://www.ird.fr" class="uri">https://www.ird.fr</a>) by Philippe Vauchel. It is based on
several tools provided by Microsoft Office (R) including Microsoft
Access. It can be obtained from <a href="https://hybam.obs-mip.fr/fr/hydraccess-2/" class="uri">https://hybam.obs-mip.fr/fr/hydraccess-2/</a></p>
<p>Hydracces is available in French, English, Spanish, Portuguese and
Russian.</p>
</div>
<div id="sqlite-data-base" class="section level2">
<h2>Sqlite data base</h2>
<p>Sqlite is an embedded data base on the public domain (<a href="https://en.wikipedia.org/wiki/SQLite" class="uri">https://en.wikipedia.org/wiki/SQLite</a>). It is
self-contained, and serverless, without preliminary configuration. It
can be installed using the instructions given by <a href="https://sqlite.org/download.html" class="uri">https://sqlite.org/download.html</a>. It can be used
directly through many dedicated applications available for a large set
of operating systems.</p>
</div>
</div>
<div id="principle" class="section level1">
<h1>Principle</h1>
<p>The Sqlite data base is organized with the same tables and fields as
the Hydraccess structure, except that the table names are changed for
practical reasons. A correspondence of these names in given in
appendix.</p>
<p>In Hydraccess, two families or time-series coexist: “hydro data”
(Type_Station = H) and “weather data” (Type_Station = M). The first one
includes the main tables Cotes/WL, Debits/DI and Qualite/QU; the second
one includes Pluies/PR and Meteo/WE. Other tables regarding discharge
measurements or calibration are also affected to the “hydro data”
family.</p>
<p>This distinction does not exist anymore in the Sqlite data base
processes. That means that one should verify if no stations have the
same name in the one and the other family. If it is the case the name
must be changed before converting a Hydraccess data base in a Sqlite
data base.</p>
<p>A time-series is always attached to a <strong>station</strong>, which
describes its location and managing infos, and to a
<strong>sensor</strong>, which is attached to the data type and to the
used device. Both are indexed with a main id.</p>
<p>In Hydraccess:</p>
<ul>
<li><p><strong>The station id</strong> has no particular syntax; it
associated to a number of description fields. Note that the station Name
field is mandatory.</p></li>
<li><p><strong>The capteur/sensor id</strong> has at most 5 digits and
the first one defines the timestep of the variable: <strong>I</strong>
for instantaneous, <strong>J</strong> for daily and <strong>M</strong>
for monthly. By convention, a daily value is affected at 12:00:00 and a
monthly value to the day 16 at 00:00:00. This convention remains for the
Sqlite data base. The other 4 digits of the sensor id are free in
Hydraccess. In the Sqlite data base the sensor id length is not any more
limited, but it could be a good idea to conserve it. Other description
fields are also associated with the sensors.</p></li>
</ul>
<p>In brief, that means that a time-series record must have 4
objects:</p>
<ul>
<li><p>a date-time;</p></li>
<li><p>a numeric value;</p></li>
<li><p>a station id factor;</p></li>
<li><p>a sensor id factor.</p></li>
</ul>
<p>Practically it associates the two tables “station” and “sensor” with
one of the five following: “water level”, “discharge”, “weather”,
“precipitation” or “quality”.</p>
<p>The other associated tables can be used for intermediary
calculations, like the computation of the discharge from the water
level, or for more detailed information.</p>
</div>
<div id="dependencies" class="section level1">
<h1>Dependencies</h1>
<p>The following packages and their own dependencies are needed to apply
the htsr package.</p>
<div id="system-library" class="section level2">
<h2>System library</h2>
<ul>
<li><code>base</code>, <code>grDevices</code>, <code>stats</code>,
<code>utils</code></li>
</ul>
</div>
<div id="user-library" class="section level2">
<h2>User library</h2>
<ul>
<li><p>included in <code>tidyverse</code>: <code>dplyr</code>,
<code>tibble</code>, <code>ggplot2</code>, <code>readr</code>,
<code>stringr</code>, <code>purrr</code></p></li>
<li><p>others: <code>DBI</code>, <code>directlabels</code>,
<code>editData</code>, <code>lubridate</code>, <code>openair</code>,
<code>raster</code>, <code>RColorBrewer</code>, <code>readxl</code>,
<code>RSQLite</code>, <code>RODBC</code>, <code>shiny</code>,
<code>WriteXLS</code>, <code>zoo</code></p></li>
</ul>
</div>
<div id="special-case-of-rodbc" class="section level2">
<h2>Special case of RODBC</h2>
<p>Because Hydraccess is only configured for Microsoft Windows, the
associated data bases work only on this platform. That means that the
operation, which consists to convert a Hydraccess data base into a
Sqlite data base must be done in this environment. The
<code>RODBC</code> package is associated to the htsr package, but it can
be only used in the Windows platform through the function
<code>d_convert_hydraccess</code>. In particular, <strong>this function
does not work on Linux</strong>.</p>
<p>Because a Hydraccess data base is proprietary depending, a
preliminary configuration of the MS-Windows platform must be done:</p>
<ul>
<li><p>Install “Microsoft Database Engine” (freely available on
Microsoft web site).</p></li>
<li><p>In the administration tools, config the connection ODBC 32b with
the Access data base to be used. An alternative consists to execute
<code>\windows\sysWOW64\odbcad32.exe</code>.</p></li>
<li><p>Open the RStudio session in 32b (this can be precised in the
RStudio general options ; RStudio must be re-launched for taking the
change into account).</p></li>
</ul>
</div>
</div>
<div id="file-formats" class="section level1">
<h1>File formats</h1>
<div id="sqlite-data-base-1" class="section level2">
<h2>Sqlite data base</h2>
<ul>
<li><p>extension : <code>.sqlite</code></p></li>
<li><p>SQLite data base with 38 tables.</p></li>
</ul>
</div>
<div id="time-series" class="section level2">
<h2>Time-series</h2>
<ul>
<li><p>extension : <code>.hts</code></p></li>
<li><p>Rdata file containing a “tibble” object, <code>tstab</code>, with
4 columns : <code>Date</code>, <code>Value</code>, <code>Station</code>,
<code>Sensor</code></p></li>
</ul>
<pre><code>&gt; tstab
   Date                Value Station Sensor
   &lt;dttm&gt;              &lt;dbl&gt; &lt;fct&gt;   &lt;fct&gt; 
 1 2015-10-03 12:00:00  2.17 CKS2500 IQ  </code></pre>
</div>
<div id="gaps" class="section level2">
<h2>Gaps</h2>
<ul>
<li><p>extension : <code>.gap</code></p></li>
<li><p>Rdata file containing a “tibble” object, <code>ze</code>, with 3
columns</p></li>
</ul>
<pre><code>&gt; ze
# A tibble: 14 x 3
   date                valeur stacapt
   &lt;dttm&gt;               &lt;dbl&gt; &lt;chr&gt;  
 1 2015-10-03 17:00:00      1 _      
 2 2015-12-11 23:30:00      1 _ </code></pre>
</div>
</div>
<div id="functions" class="section level1">
<h1>Functions</h1>
<p>6 categories of functions are provided by the htsr package, with, in
addition, one short-cut function. They are distinguished with a prefix
character and listed below.</p>
<p>Infos on their uses are detailed in the on-line help or using in the
console the command <code>?&lt;FUNCTION_NAME&gt;</code> or
<code>help(&lt;FUNCTION_NAME&gt;)</code>.</p>
<div id="short-cut-function" class="section level2">
<h2>Short-cut function</h2>
<ul>
<li><code>fc(file)</code>, shortcut for file.choose(file), which is very
frequently needed.</li>
</ul>
</div>
<div id="data-base-functions-prefix-d_-or-ds_" class="section level2">
<h2>Data base functions (prefix <code>d_</code> or
<code>ds_</code>)</h2>
<div id="data-base-tools" class="section level3">
<h3>Data base tools</h3>
<ul>
<li><p><code>d_backup(fsq)</code>, backups a htsr sqlite data
base.</p></li>
<li><p><code>d_compact(bd.sqlite)</code>, compacts a htsr sqlite data
base</p></li>
<li><p><code>d_create(fsq, cr_table = TRUE, bku = TRUE)</code>, creates
a htsr sqlite data base</p></li>
<li><p><code>d_inventory(fsq, stalist = NA, form.out = NA)</code> or
<code>ds_inventory(fsq)</code>, makes the inventory of a htsr sqlite
data base. The second is a Shiny interface of
<code>d_inventory</code></p></li>
<li><p><code>d_sensor(fsq, op = &quot;C&quot;, sta, sen, table = NA, name_fld = NA, value_fld = NA, bku = TRUE)</code>,
or <code>ds_station(fsq)</code>, creates, modifies or removes a sensor.
The second is a Shiny interface of <code>d_sensor</code></p></li>
<li><p><code>d_station(fsq, op = &quot;C&quot;, sta = NA, name_st = NA, name_fld = NA, value_fld = NA, bku = TRUE)</code>,
or <code>ds_station(fsq)</code>, creates, modifies or removes a station.
The second is a Shiny interface of <code>d_station</code></p></li>
<li><p><code>d_table(fsq, table, op = &quot;C&quot;, bku = TRUE)</code> creates or
removes a table</p></li>
</ul>
</div>
<div id="data-importexport" class="section level3">
<h3>Data import/export</h3>
<ul>
<li><p><code>d_exp_discalib(fsq, sta, calib=TRUE, dism=TRUE)</code>,
exports discharge measurements and calibrations from data base</p></li>
<li><p><code>d_exp_hts(fsq, sta, sen, rtime = FALSE, dstart, dend, rplot = FALSE)</code>
or <code>ds_exp_hts(fsq)</code>, extract hts files from a sqlite data
base. The second is a shiny interface of <code>d_exp_hts</code></p></li>
<li><p><code>d_imp_hts(fsq, file, table, bku = TRUE)</code>, imports a
hts file into a data base</p></li>
<li><p><code>d_rem_hts(fsq, table, sta, sen, start = NA, end = NA)</code>,
removes a htsr record from a data base</p></li>
<li><p><code>d_wind(fsq, sta = NA, swd = NA, swv = NA)</code>, creates a
wind table</p></li>
</ul>
</div>
<div id="conversion" class="section level3">
<h3>Conversion</h3>
<ul>
<li><p><code>d_convert_hydraccess(fsq, db.hydraccess)</code>, converts a
full Hydraccess database into a new htsr sqlite database.
<strong>NB:</strong> Only works in Windows environment with a 32b R
session.</p></li>
<li><p><code>d_convert_weewx(fsq, db.weewx, sta, name_st, tzo = &quot;CET&quot;, bku = TRUE)</code>,
converts a weewx data base (<a href="http://weewx.com/" class="uri">http://weewx.com/</a>) into a htsr sqlite base</p></li>
</ul>
</div>
</div>
<div id="file-functions-prefix-f_" class="section level2">
<h2>File functions (prefix <code>f_</code>)</h2>
<ul>
<li><p><code>f_change_id(file, sta, sen, overwrite)</code>, changes
station id or sensor id in a hts file.. Generates a file with the prefix
<code>nw_</code>.</p></li>
<li><p><code>f_convert(file, form_start = &quot;hts&quot;, form_end = &quot;xlsx&quot;, ta = NA, sen = NA, output = NA, variable = NA)</code>,
converts data-series file in another format: <code>hts</code>,
<code>xls/xlsx</code>, <code>csv</code>) and viceversa.</p></li>
<li><p><code>f_csv_multivar(files, daily = TRUE, fileo = &quot;fileo&quot;)</code>,
build a multivariable table file in csv format.</p></li>
<li><p><code>f_properties(file, gaps = FALSE)</code> displays the
properties of a hts time-series.</p></li>
</ul>
</div>
<div id="hydro-meteo-time-series-prefix-h_-or-hs_" class="section level2">
<h2>Hydro-meteo time-series (prefix <code>h_</code> or
<code>hs_</code>)</h2>
<div id="data-manipulations" class="section level3">
<h3>Data manipulations</h3>
<ul>
<li><p><code>h_addna(file)</code>, adds records with NA in a time series
at given dates. The output file is named with the prefix
<code>nap_</code>.</p></li>
<li><p><code>h_common(files)</code>, extracts 2 (or more) time-series on
their common period. Generates a file with the prefix
<code>co_</code>.</p></li>
<li><p><code>h_condition(files, condition)</code>, conditionally
extracts a time-series regarding another one. Generates a file with the
prefix <code>cd_</code>.</p></li>
<li><p><code>h_cumul(file, start = NA, end = NA)</code>, cumulates the
values of a time-series. Generates a file with the prefix
<code>cu_</code>.</p></li>
<li><p><code>h_nodata(file, threshold=NA, test=&quot;=&quot;, start=NA, end=NA)</code>,
replaces values with NA conditionally or in a time interval. Generates a
file with the prefix <code>na_</code>.</p></li>
<li><p><code>h_rbind(files, sensor, gap = TRUE)</code>, binds 2
time-series on consecutive periods</p></li>
<li><p><code>h_replace(file, old.val, new.val)</code>, replaces a value
by another. Generates a file with the prefix <code>re_</code>.</p></li>
<li><p><code>h_rollav (file, ti = 7, position = c(&quot;central&quot;, &quot;right&quot;))</code>,
computes a rolling average of a daily time-series. Generates a file with
the prefix <code>ro_</code>.</p></li>
<li><p><code>h_substitute(files)</code>, substitutes the missing values
in a series by existing values of another series. Generates a file with
the prefix <code>su_</code>.</p></li>
<li><p><code>h_weightedsum(files, weights = NA, constant = 0)</code>,
makes a weighted sum of time-series. Generates a file with the prefix
<code>ws_</code>.</p></li>
</ul>
</div>
<div id="data-critics" class="section level3">
<h3>Data critics</h3>
<ul>
<li><p><code>h_gaperr(file, nv = 1, itv0 = 43201, df)</code>, replaces
errors with gaps in a time-series based on neighboring values. Generates
a file with the prefix <code>eg_</code>.</p></li>
<li><p><code>h_gapfill(file, npdt)</code>, produces a simple gapfilling
in a time-series. Generates a file with the prefix
<code>gf_</code>.</p></li>
<li><p><code>h_gaprem_itv(file, itv0 = 43201)</code>, removes gaps in a
time-series with a time interval threshold. Generates a file with the
prefix <code>gr_</code>.</p></li>
</ul>
</div>
<div id="time-treatments" class="section level3">
<h3>Time treatments</h3>
<ul>
<li><p><code>hs_step(file)</code>, combines in a shiny environment both
functions <code>h_timestep()</code> and <code>h_month()</code></p></li>
<li><p><code>h_timestep(file, tst, op = &quot;M&quot;)</code>, computes
infra-daily data with a fixed time step. Generates a file with the
suffix <code>_xxxx</code>, where xxxx is the <code>tst</code>
value.</p></li>
<li><p><code>h_month(file, op=&quot;M&quot;, ba=NA, rmna=FALSE, climedit=FALSE, caledit_j=FALSE, caledit_m=FALSE, gapfill=FALSE)</code>,
makes monthly operations, based on a daily time-series. Generates hts
files with the suffixes <code>_C</code>, <code>_G</code> or
<code>_M</code> and MS Excel files with the prefixes <code>ad_</code>
and <code>cm_</code>.</p></li>
<li><p><code>h_restrict(file, start=NA, end=NA)</code>, restricts a
series between 2 dates. Generates hts files with the suffixes
<code>re_</code>.</p></li>
<li><p><code>h_season(file, monthstart)</code>, produces a seasonal
selection. Generates a file with the prefix <code>sx_</code>, where x is
2, 3 or 4.</p></li>
</ul>
</div>
<div id="hydro-meteo-processes" class="section level3">
<h3>Hydro-meteo processes</h3>
<ul>
<li><p><code>h_stat_basic(file)</code>, gives basic statistics of a
time-series</p></li>
<li><p><code>h_wl_di(fsq, sta, seni, seno, dstart = NA, dend = NA, dbo = TRUE)</code>,
computes a discharge time-series from water levels data and calibration
curves.</p></li>
<li><p><code>h_rainsnow(fpr, fta, ta0,ta1,sta=NA)</code>, shares the
solid and liquid precipitations with a temperature criteria. Generates a
file with the prefix <code>pr_</code>. Generates a file with the prefix
<code>sn_</code>.</p></li>
</ul>
</div>
</div>
<div id="plot-functions-prefix-p_-or-ps_" class="section level2">
<h2>Plot functions (prefix <code>p_</code> or <code>ps_</code>)</h2>
<div id="general-plots" class="section level3">
<h3>General plots</h3>
<ul>
<li><p><code>ps_plothts(files)</code>, plots hts files. Shiny interface
of <code>p_line</code> &amp; <code>p_bar</code></p></li>
<li><p>Bar plotting</p>
<ul>
<li><p><code>p_bar(nbst = nbst, filei, serlab, title, type, rnorm, rtime, start, end, rfixy, y.down = NA, y.up = NA, pal)</code></p></li>
<li><p><code>p_bar_app(filename = NA, pset = TRUE, pfil = TRUE, rpal = 0,savefig = FALSE, width = 8, height = 6, fileo = &quot;plot.png&quot;</code></p></li>
</ul></li>
<li><p>Line / point plotting</p>
<ul>
<li><p><code>p_line(nbst, filei, serlab, title, type, rnorm, rtime, start, end, rfixy, y.down, y.up, pal = pal, linet, rppt, pointt, linew, smooth)</code></p></li>
<li><p><code>p_line_app (filename = NA, pset = TRUE, pfil = TRUE, rpal = 0, smooth = FALSE, savefig = FALSE, width = 8, height = 6, fileo = &quot;plot.png&quot;)</code></p></li>
</ul></li>
</ul>
</div>
<div id="other-plots" class="section level3">
<h3>Other plots</h3>
<ul>
<li><p><code>p_box_month(file, title = &quot;Title&quot;, axeY = &quot;Y-axis&quot;, savefig = FALSE, fileo = &quot;plot.png&quot;, width = 8, height = 6)</code>,
plots a boxplot of the 12 months of a time-series.</p></li>
<li><p><code>p_clim(p_clim &lt;- function (files, type=&quot;line&quot;, hydro.month=1, title=&quot;Title&quot;, yaxis=&quot;Value&quot;, y.down=NA, y.up=NA, rpal=FALSE, pal=mapalette, legend.l=NA))</code>,
plots climatologies in hydrological year.</p></li>
<li><p><code>p_discalib(fcalib, sen, plotcalib= TRUE, plotdism=TRUE, title=&quot;Title&quot;, savefig=FALSE, width= 8, height= 6, fout=&quot;plot.png&quot;, limx =FALSE, limy = FALSE, xinf=NA, xsup=NA, yinf=NA, ysup=NA)</code>,
plots calibration curves water levels vs discharges.</p></li>
<li><p><code>p_gaps(nbf, title = &quot;Inventory&quot;, BW = FALSE, margin = 0.1)</code>,
plots of data inventory</p></li>
<li><p><code>p_hypso(file, abbrev, prop = FALSE, range=50, fact=5, title=&quot;Title&quot;, savefig=FALSE, width= 8,height= 6, fileo=&quot;plot.png&quot;)</code>,
plots the hypsometry curve of one or more basins</p></li>
<li><p><code>p_scatter(files, intercept.zero = FALSE, remove.zero = FALSE, lg.axis = c(NA, NA),title = &quot;Title&quot;)</code>,
plots a scatter plot of 2 or more time-series</p></li>
<li><p><code>p_wind(data_wind, ws.int = 0.5, angle = 45, grid.line = 10, type = &quot;default&quot;,  breaks = 5, offset = 5, paddle = FALSE)</code>,
plots wind rose</p></li>
</ul>
</div>
</div>
<div id="weather-functions-prefix-w_" class="section level2">
<h2>Weather functions (prefix <code>w_</code>)</h2>
<ul>
<li><p><code>w_atmp_alt (f_atmp, f_temp, alt0 = 0, alt)</code> computes
atmospheric pressure, function of altitude.</p></li>
<li><p><code>w_etp (method = c(&quot;Turc&quot;, &quot;Penman-Monteith&quot;, &quot;Priestley-Taylor&quot;, &quot;Makkink&quot;, &quot;Heargraves-Samani&quot;), freq = c(&quot;day&quot;, &quot;month&quot;), f_temp, f_relh = NA, f_radg = NA, f_radn = NA, f_atmp = NA, f_wvel = NA, f_tmin = NA, f_tmax = NA, lat = NA, alt = NA, albedo = NA, z = NA)</code>,
computes the potential evapotranspiration with several methods.
Generates a file with the prefix <code>xEtpyy_</code>, where x is J
(daily) or M (monthly), and yy is Tu (Turc), PM (Penman-Monteith), PT
(Priestley-Taylor), Ma (Makkink) or HS (Heargraves-Samani).</p></li>
<li><p><code>w_temp_alt (file , alt0 = 0, alt, grad = -0.0065)</code>
computes temperature, function of altitude</p></li>
</ul>
</div>
<div id="miscellaneous-functions-prefix-z_" class="section level2">
<h2>Miscellaneous functions (prefix <code>z_</code>)</h2>
<ul>
<li><p><code>z_coord(ncoord = NA, ccoord = NA, type)</code>, converts
coordinate from numeric to character and reverse.</p></li>
<li><p><code>z_set (tz = FALSE, mapal = FALSE, confp = FALSE)</code>,
edit settings for time zone and manual palette colors</p></li>
</ul>
</div>
</div>
<div id="development-main-references" class="section level1">
<h1>Development main references</h1>
<div id="sqlite-management" class="section level2">
<h2>SQLite management</h2>
<ul>
<li><p>SQLite, sql database engine, 2017, Tutorial Point, <a href="https://www.tutorialspoint.com/sqlite/sqlite_pdf_version.htm" class="uri">https://www.tutorialspoint.com/sqlite/sqlite_pdf_version.htm</a></p></li>
<li><p>Ripley B., ODBC Connectivity, 2020. <a href="https://CRAN.R-project.org/package=RODBC" class="uri">https://CRAN.R-project.org/package=RODBC</a></p></li>
<li><p><a href="https://www.sqlite.org/index.html" class="uri">https://www.sqlite.org/index.html</a></p></li>
</ul>
</div>
<div id="r-coding" class="section level2">
<h2>R coding</h2>
<ul>
<li><p>Chang W., 2013. R Graphics Cookbook. O’Reilly. 398p. ISBN
978-1-449-31695-2. Actualized on <a href="https://r-graphics.org/" class="uri">https://r-graphics.org/</a></p></li>
<li><p>Wickham H., 2015. R Packages - Organize, test, document, and
share your code. O’Reilly. 190p. ISBN 978-1-491-91059-7. Actualized
version on <a href="https://r-pkgs.org/" class="uri">https://r-pkgs.org/</a></p></li>
<li><p>Wickham H. &amp; Grolemund G., 2017. R for Data Science - Import,
tidy, transform, visualize, and model data. O’Reilly. 494p. ISBN
978-1-491-91039-9. <a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a></p></li>
<li><p><a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a></p></li>
</ul>
</div>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="correspondence-of-the-data-base-tables-between-hydraccess-and-sqlite-htsr" class="section level2">
<h2>Correspondence of the data base tables between Hydraccess and Sqlite
htsr</h2>
<div id="main-tables" class="section level3">
<h3>Main tables</h3>
<pre><code>--------------------------------------------
  Designation     Hydraccess    Sqlite name 
--------------- -------------- -------------
   Discharge        Debits          DI      
 Precipitation      Pluies          PR      
    Quality        Qualite          QU      
    Sensors        Capteurs         SS      
    Station      Station_Base       ST      
    Weather         Meteo           WE      
  Water level       Cotes           WL      
--------------------------------------------
</code></pre>
</div>
<div id="other-tables" class="section level3">
<h3>Other tables</h3>
<pre><code>--------------------------------------------------------------
        Designation              Hydraccess       Sqlite name 
--------------------------- -------------------- -------------
           Basin                  Bassins             BA      
     Calibration Date            Etal_Dates           CD      
          Country                Zones_Pays           CO      
 Disch. measur. proceeding     Jaugeages_Dep          DP      
   Discharge measurement         Jaugeages            DM      
      Elevation zero              Zero_NG             EZ      
         Equipment              Equipements           EQ      
           Event                 Evenements           EV      
        Large basis            Bassins_Grands         LB      
  Liquid flow calibration         Etal_HQ             LC      
          Manager              Gestionnaires          MG      
         Nature id              Codes_Nature          NC      
      Operating mode         Modes_Opératoires        OM      
        Origine id.            Codes_Origine          OC      
          Profile               Profils_Data          PF      
       Profile data             Profils_Data          PD      
         Propeller                Helices             PP      
        Quality id.            Codes_Qualite          QC      
          Region                  Regions             RE      
           River                  Rivieres            RV      
       Sensor comm.            Capteurs_Comm          SM      
      Sensor history          Capteurs_HistApp        SH      
         Settings               Parametrage           SE      
        Small basin            Bassins_Petits         SB      
  Solid flow calibration          Etal_HK             SC      
     Station equipment       Stations_Equipment       SQ      
       Station file          Dossiers_Stations        SF      
         Sub-zone                Zone_Sous            SZ      
       Temp_station2           Temp_Stations2         TS      
           Valve                   Vannes             VA      
           Zone                    Zones              ZO      
--------------------------------------------------------------</code></pre>
</div>
</div>
<div id="fields-of-the-main-tables" class="section level2">
<h2>Fields of the main tables</h2>
<p>They correspond to French spelling, which is used in Hydraccess. The
compulsory fields are marked with (!).</p>
<div id="stations_basest" class="section level3">
<h3>Stations_Base/ST</h3>
<p>Ordre, Type_Station (!), Id_Station (!), Id_Secondaire, Id_Tertiaire,
Type_Meteo, Nom, Pays, Zone, SousZone, GrandBassin, Bassin, PetitBassin,
Riviere, Gestionnaire, Latitude, Longitude, Altitude, Superficie_bv,
Mois_Debut_Hydro, Debut_Activite, Activite, Critere_OuiNon,
Critere_Numerique, Critere_Texte, Nom_Observateur, Adresse,
Teletransmission, Enregistreur, Fictive, Commentaire, Flag, District,
Localite</p>
</div>
<div id="capteursss" class="section level3">
<h3>Capteurs/SS</h3>
<p>Type_Station (!), Id_Station (!), Capteur (!), Table (!), Nature,
Description, Commentaire, Code_Limni, Principal, Fictif,
Maj_Journaliers, Maj_Traduction, Acquisition_Auto, Operationnel,
Liste_Inst, Liste_Jour, Liste_Mois, Agregation, Decalage_Temps, Mini,
Maxi, Gradient_Maxi, Precision, Decimales, Pente</p>
</div>
<div id="coteswl-debitsdi-meteowe-qualitequ" class="section level3">
<h3>Cotes/WL, Debits/DI, Meteo/WE, Qualite/QU</h3>
<p>Type_Station (!), Id_Station (!), Capteur (!), Table (!), Date (!),
Valeur, Origine, Qualite</p>
</div>
<div id="pluiespr" class="section level3">
<h3>Pluies/PR</h3>
<p>Type_Station (!), Id_Station (!), Capteur (!), Table (!), Date (!),
Valeur, Origine, Qualite, Nature</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
